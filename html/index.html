<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="./">
    <title>ã€Šç”¨ IO Monad æ­å»º LLM Agentï¼šä» Kleisli åˆ°äº‹ä»¶å»ºæ¨¡ä¸ FRPã€‹ç›®å½•ï¼ˆindex.mdï¼‰</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="assets/highlight.css">
    <script src="assets/script.js" defer></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: false,
                packages: {'[+]': ['noerrors', 'ams']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            loader: {
                load: ['[tex]/noerrors', '[tex]/ams']
            }
        };
    </script>
</head>
<body>
    <div class="container">
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h3>ç›®å½•</h3>
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
            <div class="sidebar-search">
                <input type="text" id="sidebar-search-input" placeholder="æœç´¢..." autocomplete="off">
            </div>
            <div id="tree-container">
                <nav class="tree-nav" role="tree">
                    <div class="tree-item active" >
                        <a href="index.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ã€Šç”¨ IO Monad æ­å»º LLM Agentï¼šä» Kleisli åˆ°äº‹ä»¶å»ºæ¨¡ä¸ FRPã€‹ç›®å½•ï¼ˆindex.mdï¼‰</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter1.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 1 â€” LLM Agent çš„â€œæŠ½è±¡è¾¹ç•Œâ€ï¼šä¸ºä»€ä¹ˆä» IO Monad å‡ºå‘</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter2.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 2 â€” IO Monad é€Ÿæˆï¼šä»æ¦‚å¿µåˆ°å·¥ç¨‹å®ç°</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter3.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 3 â€” Kleisli Arrowï¼šæŠŠâ€œå¸¦ IO çš„å‡½æ•°â€å½“ä½œå¯ç»„åˆç®­å¤´</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter4.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 4 â€” Agent DSLï¼šæŠŠå·¥å…·ã€è®°å¿†ä¸æ§åˆ¶æµåšæˆâ€œå¯è§£é‡Šçš„ effectâ€</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter5.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 5 â€” Runtime ä¸è°ƒåº¦ï¼šä»è§£é‡Šå™¨åˆ°å¹¶å‘ã€å–æ¶ˆä¸èµ„æºç®¡ç† (chapter5.md)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter6.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 6 â€” äº‹ä»¶å»ºæ¨¡ï¼šIO timeoutã€é‡è¯•ã€é€€é¿ã€ç†”æ–­ä¸é¢„ç®—</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter7.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 7 â€” Coding Agent çš„ Loop Detectionï¼šè®© Agent å¯ç»ˆæ­¢ã€å¯è§£é‡Š</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter8.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 8 â€” A/B Test ä¸è¯„ä¼°ï¼šæŠŠå®éªŒåµŒè¿› IO/Kleisli ç®¡é“</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter9.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 9 â€” å¯è§‚æµ‹æ€§ï¼šTrace/Spanã€æ—¥å¿—ã€æŒ‡æ ‡ä¸å¯å¤ç°</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter10.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 10 â€” ä¸ FRP çš„å…³ç³»ï¼šå½“ Agent å˜æˆâ€œäº‹ä»¶æµå¤„ç†å™¨â€ (chapter10.md)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter11.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 11 â€” ç»¼åˆæ¡ˆä¾‹ï¼šå®ç°ä¸€ä¸ªå¯æ’æ‹”çš„ Coding Agent (chapter11.md)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter12.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 12 â€” æ‰©å±•é˜…è¯»ä¸è·¯çº¿å›¾ï¼šé€šå¾€ç±»å‹å®‰å…¨ä¸ç”Ÿäº§ç¯å¢ƒçš„å½¼å²¸</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter13.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 13 â€” é™„å½•ï¼šç»ˆæå‚è€ƒæ‰‹å†Œ (The Ultimate Reference)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter14.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Chapter 14 â€” Search API + RAGï¼šæ„å»ºæ£€ç´¢å¢å¼ºçš„ RAG Agent</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="CLAUDE.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                </nav>
            </div>
        </nav>
        
        <main class="content">
            <article>
                <h1 id="io-monad-llm-agent-kleisli-frpindexmd">ã€Šç”¨ IO Monad æ­å»º LLM Agentï¼šä» Kleisli åˆ°äº‹ä»¶å»ºæ¨¡ä¸ FRPã€‹ç›®å½•ï¼ˆindex.mdï¼‰</h1>
<blockquote>
<p>æœ¬æ•™ç¨‹é¢å‘ï¼šæƒ³æŠŠ LLM agent æŠ½è±¡æˆâ€œå¯ç»„åˆçš„ã€å¯æµ‹è¯•çš„ã€å¯è§‚æµ‹çš„ effectful programâ€çš„å·¥ç¨‹/ç ”ç©¶è¯»è€…ã€‚<br />
å†™ä½œç›®æ ‡ï¼šç”¨ <strong>IO Monad / Kleisli Arrow</strong> ç»Ÿä¸€ agent çš„â€œè°ƒç”¨å·¥å…·ã€è¯»å†™è®°å¿†ã€è¶…æ—¶é‡è¯•ã€æ—¥å¿—è¿½è¸ªã€A/B å®éªŒã€å¾ªç¯æ£€æµ‹â€ç­‰æœºåˆ¶ï¼Œå¹¶è§£é‡Šå…¶ä¸ <strong>Functional Reactive Programming (FRP)</strong> çš„å…³ç³»ã€‚<br />
ä»£ç é£æ ¼ï¼šä¼ªä»£ç  + å¯è½åœ°çš„ç±»å‹ç­¾åï¼›ç¤ºä¾‹ä¼šè¦†ç›– <em>Haskell/Scala/F#/TypeScript(å‡½æ•°å¼é£æ ¼)</em> çš„å¯¹ç…§ï¼ˆæ¯ç« æœ«å°¾ç»™â€œè¯­è¨€æ˜ å°„â€å°èŠ‚ï¼‰ã€‚</p>
</blockquote>
<hr />
<h2 id="_1">ä»“åº“ç»“æ„ï¼ˆå»ºè®®ï¼‰</h2>
<ul>
<li><code>index.md</code>ï¼ˆä½ æ­£åœ¨é˜…è¯»ï¼‰</li>
<li><code>chapter1.md</code>ï¼šä¸ºä»€ä¹ˆç”¨ IO Monad æŠ½è±¡ LLM agent</li>
<li><code>chapter2.md</code>ï¼šIO Monad é€Ÿæˆä¸å·¥ç¨‹åŒ–</li>
<li><code>chapter3.md</code>ï¼šKleisli Arrow æ˜¯ä»€ä¹ˆã€ä¸ºä»€ä¹ˆå¯¹ agent ç‰¹åˆ«åˆé€‚</li>
<li><code>chapter4.md</code>ï¼šAgent DSLï¼šæŠŠâ€œå·¥å…·/è®°å¿†/æ§åˆ¶æµ/æŒ‡æ ‡â€éƒ½å˜æˆ effect</li>
<li><code>chapter5.md</code>ï¼šè¿è¡Œæ—¶ï¼ˆRuntimeï¼‰ï¼šè§£é‡Šå™¨ã€è°ƒåº¦å™¨ã€å¹¶å‘ä¸å–æ¶ˆ</li>
<li><code>chapter6.md</code>ï¼šäº‹ä»¶å»ºæ¨¡ï¼štimeout / retry / backoff / circuit breaker / budget</li>
<li><code>chapter7.md</code>ï¼šCoding Agentï¼šloop detection ä¸â€œå®‰å…¨å¯ç»ˆæ­¢â€ä¿è¯</li>
<li><code>chapter8.md</code>ï¼šå®éªŒä¸è¯„ä¼°ï¼šA/B testã€interleavingã€ç¦»çº¿å›æ”¾ä¸åäº‹å®</li>
<li><code>chapter9.md</code>ï¼šå¯è§‚æµ‹æ€§ï¼štraceã€spanã€ç»“æ„åŒ–æ—¥å¿—ã€å› æœä¸å¯å¤ç°</li>
<li><code>chapter10.md</code>ï¼šä¸ FRP çš„å…³ç³»ï¼šäº‹ä»¶æµé©±åŠ¨ agentã€æµå¼ token ä¸ UI</li>
<li><code>chapter11.md</code>ï¼šç»¼åˆæ¡ˆä¾‹ï¼šä»é›¶å®ç°ä¸€ä¸ªå¯æ’æ‹”çš„ coding agent</li>
<li><code>chapter12.md</code>ï¼šæ‰©å±•é˜…è¯»ï¼šFree/Final Taglessã€Algebraic Effectsã€Arrowized FRP</li>
</ul>
<blockquote>
<p>ä½ åç»­å¯ä»¥æŒ‰è¿™ä¸ªç´¢å¼•é€ç« ç”Ÿæˆ <code>chapterX.md</code>ã€‚</p>
</blockquote>
<hr />
<h2 id="chapters-sections">å…¨ä¹¦å¯¼èˆªï¼ˆChapters &amp; Sectionsï¼‰</h2>
<h3 id="chapter-1-llm-agent-io-monad-chapter1md">Chapter 1 â€” LLM Agent çš„â€œæŠ½è±¡è¾¹ç•Œâ€ï¼šä¸ºä»€ä¹ˆä» IO Monad å‡ºå‘ï¼ˆchapter1.mdï¼‰</h3>
<p>1.1 Agent åˆ°åº•æ˜¯ä»€ä¹ˆï¼šå‡½æ•°ã€è¿›ç¨‹ã€è¿˜æ˜¯çŠ¶æ€æœºï¼Ÿ<br />
1.2 å…¸å‹ agent ä»£ç ä¸ºä½•ä¼šâ€œéš¾ç»„åˆã€éš¾æµ‹ã€éš¾å¤ç°â€<br />
1.3 æŠŠ agent è§†ä¸ºï¼š<code>Input -&gt; IO Output</code> çš„å¯ç»„åˆè®¡ç®—<br />
1.4 â€œå·¥å…·è°ƒç”¨/è®°å¿†/ç½‘ç»œ/æ–‡ä»¶/äººç±»åé¦ˆâ€éƒ½æ˜¯ IO effect<br />
1.5 æŠ½è±¡çš„æ”¶ç›Šæ¸…å•ï¼šç»„åˆæ€§ã€å¯æ›¿æ¢æ€§ã€å¯æµ‹è¯•æ€§ã€å¯è§‚æµ‹æ€§<br />
1.6 ä¸€ä¸ªæœ€å° agentï¼šä» prompt-only åˆ° tool-augmented<br />
1.7 ç« èŠ‚å°ç»“ï¼šæœ¬ä¹¦ä¼šç»Ÿä¸€å“ªäº›é—®é¢˜ï¼ˆloopã€A/Bã€timeoutã€äº‹ä»¶æµï¼‰</p>
<hr />
<h3 id="chapter-2-io-monad-chapter2md">Chapter 2 â€” IO Monad é€Ÿæˆï¼šä»æ¦‚å¿µåˆ°å·¥ç¨‹å®ç°ï¼ˆchapter2.mdï¼‰</h3>
<p>2.1 Monad ä¸‰ä»¶å¥—ï¼š<code>pure</code> / <code>bind(&gt;&gt;=)</code> / <code>map</code><br />
2.2 IO çš„ç›´è§‰ï¼šæŠŠâ€œä¸–ç•Œäº¤äº’â€å°è£…ä¸ºå€¼ï¼ˆæè¿°ï¼‰<br />
2.3 ç»„åˆ effectï¼šé”™è¯¯ï¼ˆEither/Resultï¼‰ã€å¯é€‰ï¼ˆOptionï¼‰ã€çŠ¶æ€ï¼ˆStateï¼‰<br />
2.4 <code>Reader</code> ä½œä¸ºä¾èµ–æ³¨å…¥ï¼šAPI keyã€é…ç½®ã€feature flag<br />
2.5 <code>Writer</code>/æ—¥å¿—ï¼šç»“æ„åŒ–æ—¥å¿— vs ä¸šåŠ¡è¾“å‡º<br />
2.6 <code>State</code>/è®°å¿†ï¼šå¯¹è¯ä¸Šä¸‹æ–‡ã€å‘é‡åº“å¥æŸ„ã€ç¼“å­˜<br />
2.7 IO ä¸å¹¶å‘ï¼šasyncã€å–æ¶ˆï¼ˆcancellationï¼‰ã€èµ„æºä½œç”¨åŸŸï¼ˆbracketï¼‰<br />
2.8 å·¥ç¨‹è½åœ°ï¼šåœ¨éçº¯è¯­è¨€é‡Œâ€œæ¨¡æ‹Ÿ IO Monadâ€ï¼ˆTypeScript/JSï¼‰<br />
2.9 ç« èŠ‚ç»ƒä¹ ï¼šæŠŠä¸€æ®µè„šæœ¬å¼ agent é‡æ„æˆç»„åˆå¼ IO</p>
<hr />
<h3 id="chapter-3-kleisli-arrow-io-chapter3md">Chapter 3 â€” Kleisli Arrowï¼šæŠŠâ€œå¸¦ IO çš„å‡½æ•°â€å½“ä½œå¯ç»„åˆç®­å¤´ï¼ˆchapter3.mdï¼‰</h3>
<p>3.1 ä»€ä¹ˆæ˜¯ Kleisliï¼š<code>a -&gt; m b</code> çš„ç»„åˆè§„åˆ™<br />
3.2 ä¸æ™®é€šå‡½æ•°ç»„åˆçš„åŒºåˆ«ï¼šä¸ºä»€ä¹ˆ <code>a-&gt;IO b</code> ä¸èƒ½ç›´æ¥ <code>(.)</code><br />
3.3 Kleisli çš„ <code>compose</code> / <code>andThen</code>ï¼šæŠŠ agent pipeline ä¸²èµ·æ¥<br />
3.4 Kleisli Categoryï¼šæŠŠâ€œeffectful stepâ€å½“ä½œ morphism<br />
3.5 åœ¨ agent ä¸­çš„æ„ä¹‰ï¼šPlannerã€ToolRouterã€MemoryUpdater éƒ½æ˜¯ Kleisli<br />
3.6 Kleisli ä¸é”™è¯¯çŸ­è·¯ï¼š<code>a -&gt; IO (Either e b)</code> çš„ç»„åˆè¯­ä¹‰<br />
3.7 Kleisli ä¸è§‚æµ‹ï¼šåœ¨ç»„åˆç‚¹æ’å…¥ tracingã€metricsã€debug hooks<br />
3.8 Kleisli vs Arrowï¼šä½•æ—¶éœ€è¦æ›´å¼ºçš„ç»“æ„ï¼ˆå¹¶è¡Œ/åˆ†æ”¯ï¼‰<br />
3.9 ç« èŠ‚å°ç»“ï¼šKleisli æ˜¯ agent çš„â€œç®¡é“èƒ¶æ°´â€</p>
<hr />
<h3 id="chapter-4-agent-dsl-effectchapter4md">Chapter 4 â€” Agent DSLï¼šæŠŠå·¥å…·ã€è®°å¿†ä¸æ§åˆ¶æµåšæˆâ€œå¯è§£é‡Šçš„ effectâ€ï¼ˆchapter4.mdï¼‰</h3>
<p>4.1 éœ€æ±‚ï¼šä¸ºä»€ä¹ˆä»…æœ‰ <code>IO</code> è¿˜ä¸å¤Ÿï¼ˆå¯æµ‹è¯•ã€å¯å›æ”¾ã€å¯æ›¿æ¢ï¼‰<br />
4.2 å®šä¹‰ Agent èƒ½åŠ›é›†åˆï¼š<code>ToolCall</code> / <code>Mem</code> / <code>Clock</code> / <code>Rand</code> / <code>Trace</code><br />
4.3 æ–¹æ¡ˆ Aï¼šFree Monadï¼ˆå‘½ä»¤å¼ DSL + Interpreterï¼‰<br />
4.4 æ–¹æ¡ˆ Bï¼šFinal Taglessï¼ˆç±»å‹ç±»/æ¥å£ + å¤šè§£é‡Šå™¨ï¼‰<br />
4.5 æŠŠ LLM è°ƒç”¨å½“ effectï¼š<code>Chat : Req -&gt; m Resp</code><br />
4.6 æŠŠå·¥å…·å½“ effectï¼š<code>Tool : ToolReq -&gt; m ToolResp</code><br />
4.7 æŠŠè®°å¿†å½“ effectï¼šKVã€å‘é‡æ£€ç´¢ã€ç»“æ„åŒ–è®°å¿†å›¾è°±<br />
4.8 æ§åˆ¶æµ effectï¼š<code>sleep</code>ã€<code>timeout</code>ã€<code>race</code>ã€<code>retry</code>ã€<code>budget</code><br />
4.9 å¯æ›¿æ¢è§£é‡Šå™¨ï¼šçœŸå®è¿è¡Œ / mock / å½•åˆ¶å›æ”¾ / æ•…éšœæ³¨å…¥<br />
4.10 ç« èŠ‚ç»ƒä¹ ï¼šå†™ä¸€ä¸ªâ€œçº¯æµ‹è¯•è§£é‡Šå™¨â€éªŒè¯ agent è¡Œä¸º</p>
<hr />
<h3 id="chapter-5-runtime-chapter5md">Chapter 5 â€” Runtime ä¸è°ƒåº¦ï¼šä»è§£é‡Šå™¨åˆ°å¹¶å‘ã€å–æ¶ˆä¸èµ„æºç®¡ç†ï¼ˆchapter5.mdï¼‰</h3>
<p>5.1 Runtime çš„è´£ä»»è¾¹ç•Œï¼šè§£é‡Šã€è°ƒåº¦ã€éš”ç¦»ã€é™æµ<br />
5.2 è¿è¡Œæ¨¡å‹ï¼šåŒæ­¥ vs å¼‚æ­¥ï¼›pull vs push<br />
5.3 å–æ¶ˆè¯­ä¹‰ï¼šç”¨æˆ·å–æ¶ˆã€è¶…æ—¶å–æ¶ˆã€ä¸Šæ¸¸å–æ¶ˆå¦‚ä½•ä¼ æ’­<br />
5.4 èµ„æºä½œç”¨åŸŸï¼šæ–‡ä»¶å¥æŸ„ã€ç½‘ç»œè¿æ¥ã€ä¸´æ—¶ç›®å½•æ¸…ç†ï¼ˆbracketï¼‰<br />
5.5 å¹¶å‘ç»„åˆï¼š<code>parTraverse</code>ã€<code>race</code>ã€<code>timeout</code> çš„ç±»å‹ä¸è¯­ä¹‰<br />
5.6 å·¥å…·è°ƒç”¨éš”ç¦»ï¼šsandboxã€æƒé™ã€é…é¢ã€é€Ÿç‡é™åˆ¶<br />
5.7 å¤šæ¨¡å‹/å¤šä¾›åº”å•†ï¼šæ¨¡å‹è·¯ç”±ã€fallbackã€å¥åº·æ£€æŸ¥<br />
5.8 ç« èŠ‚å°ç»“ï¼šRuntime æ˜¯â€œè®© DSL å˜æˆç°å®â€çš„æœºå™¨</p>
<hr />
<h3 id="chapter-6-io-timeoutchapter6md">Chapter 6 â€” äº‹ä»¶å»ºæ¨¡ï¼šIO timeoutã€é‡è¯•ã€é€€é¿ã€ç†”æ–­ä¸é¢„ç®—ï¼ˆchapter6.mdï¼‰</h3>
<p>6.1 â€œäº‹ä»¶â€æ˜¯ä»€ä¹ˆï¼šå¯è§‚æµ‹çš„æ—¶é—´ç‚¹/åŒºé—´çŠ¶æ€å˜åŒ–<br />
6.2 Timeout çš„å»ºæ¨¡ï¼š  </p>
<ul>
<li>6.2.1 <code>timeout : Duration -&gt; m a -&gt; m (Maybe a)</code>  </li>
<li>6.2.2 <code>timeoutOr : Duration -&gt; e -&gt; m a -&gt; m (Either e a)</code>  </li>
<li>
<p>6.2.3 è¶…æ—¶æ˜¯å¼‚å¸¸ï¼Ÿæ˜¯å€¼ï¼Ÿæ˜¯äº‹ä»¶ï¼Ÿå„è‡ª trade-off<br />
6.3 Retry çš„å»ºæ¨¡ï¼šé‡è¯•ç­–ç•¥ä½œä¸ºæ•°æ®ï¼ˆPolicyï¼‰<br />
6.4 Backoff/Jitterï¼šé¿å…ç¾Šç¾¤æ•ˆåº”ï¼›å¦‚ä½•æŠŠéšæœºæ€§çº³å…¥ effectï¼ˆRandï¼‰<br />
6.5 Circuit Breakerï¼šåŠå¼€/å…³é—­/æ‰“å¼€çŠ¶æ€æœºï¼ˆState + Clockï¼‰<br />
6.6 Budget/é…é¢ï¼štoken budgetã€å·¥å…·è°ƒç”¨æ¬¡æ•°ã€wall-clock budget<br />
6.7 Deadline vs Timeoutï¼šç»å¯¹æˆªæ­¢æ—¶é—´çš„ç»„åˆæ€§æ›´å¥½<br />
6.8 Rate limitï¼šä»¤ç‰Œæ¡¶/æ¼æ¡¶ä½œä¸º effectï¼ˆæˆ–è§£é‡Šå™¨èƒ½åŠ›ï¼‰<br />
6.9 æ•…éšœæ³¨å…¥ï¼šç½‘ç»œæŠ–åŠ¨ã€æ…¢å“åº”ã€éƒ¨åˆ†å¤±è´¥ï¼ˆç”¨äºé²æ£’æ€§æµ‹è¯•ï¼‰<br />
6.10 â€œå†ä¸¾ä¸€äº›äº‹ä»¶â€ï¼š  </p>
</li>
<li>
<p>tool è¿”å›ç»“æ„ä¸åˆæ³•ï¼ˆschema errorï¼‰  </p>
</li>
<li>æƒé™æ‹’ç»ï¼ˆauthzï¼‰  </li>
<li>è¾“å‡ºè¢«å®‰å…¨ç­–ç•¥æˆªæ–­ï¼ˆpolicy truncationï¼‰  </li>
<li>ä¸Šä¸‹æ–‡æº¢å‡ºï¼ˆcontext overflowï¼‰  </li>
<li>è®°å¿†åº“ä¸å¯ç”¨ï¼ˆvector db downï¼‰  </li>
<li>å…³é”®ä¾èµ–é™çº§ï¼ˆdegraded modeï¼‰<br />
6.11 ç« èŠ‚å°ç»“ï¼šæŠŠäº‹ä»¶å˜æˆå¯ç»„åˆçš„â€œå€¼/æµ/çŠ¶æ€â€</li>
</ul>
<hr />
<h3 id="chapter-7-coding-agent-loop-detection-agent-chapter7md">Chapter 7 â€” Coding Agent çš„ loop detectionï¼šè®© agent å¯ç»ˆæ­¢ã€å¯è§£é‡Šï¼ˆchapter7.mdï¼‰</h3>
<p>7.1 Coding agent çš„å¸¸è§â€œæ­»å¾ªç¯â€ç±»å‹ï¼š  </p>
<ul>
<li>ä¿®åŒä¸€ä¸ª bug æ¥å›æ”¹  </li>
<li>æµ‹è¯•å¤±è´¥â†’çæ”¹â†’æ›´ç³Ÿ  </li>
<li>
<p>å·¥å…·è°ƒç”¨é‡å¤ï¼ˆåŒä¸€å‘½ä»¤/åŒä¸€è¡¥ä¸ï¼‰<br />
7.2 Loop detection ä½œä¸º effectï¼š<code>DetectLoop : Trace -&gt; m Decision</code><br />
7.3 ä¿¡å·æ¥æºï¼ˆfeaturesï¼‰ï¼š  </p>
</li>
<li>
<p>æœ€è¿‘ N æ¬¡ action çš„ n-gram  </p>
</li>
<li>patch/AST diff ç›¸ä¼¼åº¦  </li>
<li>tool è°ƒç”¨åºåˆ—çš„é‡å¤å­ä¸²  </li>
<li>
<p>failure signatureï¼ˆåŒä¸€é”™è¯¯æ ˆ/åŒä¸€æµ‹è¯•ç”¨ä¾‹ï¼‰<br />
7.4 åˆ¤å®šç­–ç•¥ï¼šé˜ˆã€æŠ•ç¥¨ã€å¤šè‡‚ banditï¼ˆå¯¹ä¸åŒç­–ç•¥ï¼‰<br />
7.5 å¤„ç½®ç­–ç•¥ï¼š  </p>
</li>
<li>
<p>è‡ªåŠ¨â€œå‡çº§è®¡åˆ’â€ï¼ˆreplanï¼‰  </p>
</li>
<li>é™æ¸©ï¼ˆcooldownï¼‰ä¸å¼ºåˆ¶æ¢ç´¢  </li>
<li>è¯·æ±‚äººç±»ä»‹å…¥ï¼ˆhuman-in-the-loopï¼‰  </li>
<li>å›æ»šåˆ° checkpoint<br />
7.6 ç»ˆæ­¢æ€§è®¾è®¡ï¼šmax stepsã€deadlineã€budgetã€çŠ¶æ€å•è°ƒæ€§<br />
7.7 ç« èŠ‚ç»ƒä¹ ï¼šå®ç°ä¸€ä¸ªâ€œé‡å¤å·¥å…·è°ƒç”¨â€æ£€æµ‹å™¨ + å•å…ƒæµ‹è¯•</li>
</ul>
<hr />
<h3 id="chapter-8-ab-test-iokleisli-chapter8md">Chapter 8 â€” A/B Test ä¸è¯„ä¼°ï¼šæŠŠå®éªŒåµŒè¿› IO/Kleisli ç®¡é“ï¼ˆchapter8.mdï¼‰</h3>
<p>8.1 ä¸ºä»€ä¹ˆ agent æ›´éœ€è¦å®éªŒï¼šéšæœºæ€§ã€éå¹³ç¨³ã€å·¥å…·ç¯å¢ƒå˜åŒ–<br />
8.2 A/B çš„æœ€å°æŠ½è±¡ï¼š<code>Assign : UserCtx -&gt; m Variant</code><br />
8.3 å®éªŒå•ä½ï¼šsessionã€taskã€stepã€tool-call çº§åˆ«çš„é€‰æ‹©<br />
8.4 æŒ‡æ ‡å»ºæ¨¡ï¼šæˆåŠŸç‡ã€è€—æ—¶ã€tokenã€å·¥å…·æˆæœ¬ã€æ»¡æ„åº¦<br />
8.5 ç»Ÿè®¡æ³¨æ„ï¼š  </p>
<ul>
<li>8.5.1 åˆ†æ¡¶ä¸€è‡´æ€§ï¼ˆsticky assignmentï¼‰  </li>
<li>8.5.2 å¹²é¢„æ³„æ¼ï¼ˆprompt contaminationï¼‰  </li>
<li>8.5.3 å¤šé‡æ¯”è¾ƒä¸ early stopping<br />
8.6 æ›´é€‚åˆç”Ÿæˆå¼çš„è¯„ä¼°ï¼šinterleavingã€pairwise preference<br />
8.7 åäº‹å®ä¸ç¦»çº¿å›æ”¾record/replay interpreter åšâ€œé‡è·‘â€<br />
8.8 ä¸ bandit/è‡ªåŠ¨è·¯ç”±ï¼šæŠŠç­–ç•¥å½“ Kleisli step<br />
8.9 ç« èŠ‚å°ç»“ï¼šå®éªŒä¸æ˜¯å¤–æŒ‚ï¼Œæ˜¯è¿è¡Œæ—¶èƒ½åŠ›</li>
</ul>
<hr />
<h3 id="chapter-9-tracespanchapter9md">Chapter 9 â€” å¯è§‚æµ‹æ€§ï¼šTrace/Spanã€æ—¥å¿—ã€æŒ‡æ ‡ä¸å¯å¤ç°ï¼ˆchapter9.mdï¼‰</h3>
<p>9.1 è§‚æµ‹çš„ä¸‰ä»¶å¥—ï¼šlogsã€metricsã€traces<br />
9.2 Trace ä½œä¸º effectï¼š<code>withSpan : Name -&gt; m a -&gt; m a</code><br />
9.3 ç»“æ„åŒ–äº‹ä»¶ï¼šToolCallStart/Endã€LLMRequest/Responseã€Timeout<br />
9.4 å› æœé“¾ï¼šæŠŠ step-idã€parent-id ä¸²èµ·æ¥ï¼ˆKleisli å¤©ç„¶é€‚é…ï¼‰<br />
9.5 å¯å¤ç°è¿è¡Œï¼š  </p>
<ul>
<li>å›ºå®šéšæœºç§å­ï¼ˆRand effectï¼‰  </li>
<li>å½•åˆ¶å¤–éƒ¨ IOï¼ˆHTTPã€æ–‡ä»¶ï¼‰  </li>
<li>ç‰ˆæœ¬é”å®šï¼ˆpromptã€æ¨¡å‹ã€å·¥å…·ï¼‰<br />
9.6 è°ƒè¯•ä¸è§£é‡Šï¼šæŠŠ reasoning/plan å½“æ•°æ®ï¼Œä¸å½“å­—ç¬¦ä¸²<br />
9.7 ç« èŠ‚ç»ƒä¹ ï¼šè¾“å‡ºä¸€ä»½â€œå¯å›æ”¾çš„æ‰§è¡Œè®°å½•â€å¹¶å¤è·‘</li>
</ul>
<hr />
<h3 id="chapter-10-frp-agent-chapter10md">Chapter 10 â€” ä¸ FRP çš„å…³ç³»ï¼šå½“ agent å˜æˆâ€œäº‹ä»¶æµå¤„ç†å™¨â€ï¼ˆchapter10.mdï¼‰</h3>
<p>10.1 FRP æ ¸å¿ƒï¼šBehaviorï¼ˆéšæ—¶é—´å˜åŒ–çš„å€¼ï¼‰ä¸ Eventï¼ˆç¦»æ•£äº‹ä»¶ï¼‰<br />
10.2 ä¸ºä»€ä¹ˆ agent ä¸ FRP ä¼šç›¸é‡ï¼š  </p>
<ul>
<li>token streaming  </li>
<li>å·¥å…·è¿›åº¦ã€é•¿ä»»åŠ¡çŠ¶æ€  </li>
<li>
<p>UI äº¤äº’ï¼ˆç”¨æˆ·éšæ—¶æ’è¯/æ‰“æ–­ï¼‰<br />
10.3 æŠŠ agent runtime åšæˆ FRPï¼š  </p>
</li>
<li>
<p>è¾“å…¥æµï¼šç”¨æˆ·æ¶ˆæ¯ã€ç³»ç»Ÿäº‹ä»¶ã€å·¥å…·å›è°ƒ  </p>
</li>
<li>
<p>è¾“å‡ºæµï¼štokenã€åŠ¨ä½œã€çŠ¶æ€å˜æ›´<br />
10.4 IO Monad vs FRPï¼š  </p>
</li>
<li>
<p>IO å¼ºè°ƒâ€œåºåˆ—åŒ–çš„ effect ç»„åˆâ€  </p>
</li>
<li>
<p>FRP å¼ºè°ƒâ€œéšæ—¶é—´ä¼ æ’­çš„ä¾èµ–å…³ç³»â€<br />
10.5 äºŒè€…ç»“åˆçš„å¸¸è§å½¢æ€ï¼š  </p>
</li>
<li>
<p><code>IO</code> é‡Œè·‘ FRP networkï¼ˆFRP ä½œä¸ºå†…éƒ¨å¼•æ“ï¼‰  </p>
</li>
<li>FRP æµé‡ŒåµŒ <code>IO</code>ï¼ˆæ¯ä¸ª event è§¦å‘ effectï¼‰<br />
10.6 è¶…æ—¶/å–æ¶ˆåœ¨ FRP ä¸­çš„è¡¨è¾¾ï¼šdebounceã€throttleã€switchMap/race<br />
10.7 ç« èŠ‚å°ç»“ï¼šFRP è§£å†³â€œæŒç»­äº¤äº’ä¸æµå¼çŠ¶æ€â€ï¼ŒIO/Kleisli è§£å†³â€œå¯ç»„åˆ effectâ€</li>
</ul>
<hr />
<h3 id="chapter-11-coding-agentchapter11md">Chapter 11 â€” ç»¼åˆæ¡ˆä¾‹ï¼šå®ç°ä¸€ä¸ªå¯æ’æ‹”çš„ coding agentï¼ˆchapter11.mdï¼‰</h3>
<p>11.1 éœ€æ±‚æ¸…å•ï¼šå·¥å…·ï¼ˆgit/test/lintï¼‰ã€è®°å¿†ã€è¶…æ—¶ã€é‡è¯•ã€loop detection<br />
11.2 å®šä¹‰ DSLï¼š<code>Chat</code>ã€<code>Tool</code>ã€<code>FS</code>ã€<code>Clock</code>ã€<code>Trace</code>ã€<code>Experiment</code><br />
11.3 å†™è§£é‡Šå™¨ï¼šçœŸå®è§£é‡Šå™¨ + mock + record/replay<br />
11.4 å†™ agent pipelineï¼ˆKleisliï¼‰ï¼šPlan -&gt; Act -&gt; Observe -&gt; Update<br />
11.5 äº‹ä»¶å¤„ç†ï¼štimeoutã€budgetã€å¤±è´¥åˆ†ç±»ä¸é™çº§<br />
11.6 loop detection æ¥å…¥ç‚¹ï¼šæ¯ä¸€æ­¥åæ£€æŸ¥ + å¯¹ç­–æ‰§è¡Œ<br />
11.7 A/Bï¼šå¯¹ä¸åŒ planner/prompt/tool-router åšå®éªŒ<br />
11.8 FRP æ¥å£ï¼šç»™ UI è¾“å‡º token ä¸è¿›åº¦æ¡<br />
11.9 ç«¯åˆ°ç«¯æ¼”ç¤ºï¼šä»â€œä¸€ä¸ª bugâ€åˆ°â€œæäº¤ PRâ€<br />
11.10 ç« èŠ‚å°ç»“ï¼šä»æŠ½è±¡åˆ°å¯è¿è¡Œç³»ç»Ÿ</p>
<hr />
<h3 id="chapter-12-chapter12md">Chapter 12 â€” æ‰©å±•é˜…è¯»ä¸è·¯çº¿å›¾ï¼ˆchapter12.mdï¼‰</h3>
<p>12.1 Free Monad vs Final Tagless vs Algebraic Effectsï¼šé€‰æ‹©æŒ‡å—<br />
12.2 Arrowã€Profunctorã€Opticsï¼šæ›´å¼ºçš„ç»„åˆå·¥å…·ç®±<br />
12.3 Arrowized FRPï¼šæŠŠ FRP ç½‘ç»œä¹Ÿå†™æˆ Arrowï¼ˆä¸ Kleisli å¯¹ç…§ï¼‰<br />
12.4 å½¢å¼åŒ–è¯­ä¹‰ï¼šå°æ­¥è¯­ä¹‰ã€å¯è¯æ˜çš„ç»ˆæ­¢æ€§/å®‰å…¨æ€§è¾¹ç•Œ<br />
12.5 å·¥ç¨‹è·¯çº¿å›¾ï¼šä» toy åˆ° productionï¼ˆå¤šç§Ÿæˆ·/åˆè§„/æˆæœ¬ï¼‰<br />
12.6 æ¨èèµ„æ–™ä¸å…³é”®è¯è¡¨ï¼ˆä¾¿äºè‡ªè¡Œæ£€ç´¢ï¼‰</p>
<hr />
<h3 id="chapter13md">é™„å½•ï¼ˆchapter13.mdï¼‰</h3>
<p>A.1 æœ¯è¯­è¡¨ï¼šMonadã€Kleisliã€Interpreterã€Effectã€FRPâ€¦<br />
A.2 ç±»å‹ç­¾åé€ŸæŸ¥è¡¨ï¼štimeout/retry/race/withSpanâ€¦<br />
A.3 å¸¸è§å‘ï¼šæŠŠæ—¥å¿—å†™è¿›ä¸šåŠ¡è¾“å‡ºã€æŠŠå¼‚å¸¸å½“æ§åˆ¶æµã€ä¸å¯å›æ”¾éšæœºæ€§<br />
A.4 ç»ƒä¹ é¢˜ä¸å‚è€ƒç­”æ¡ˆç´¢å¼•ï¼ˆæŒ‰ç« èŠ‚ç¼–å·ï¼‰</p>
<h3 id="chapter-14-search-api-rag-rag-agentchapter14md">Chapter 14 â€” Search API + RAGï¼šæ„å»ºæ£€ç´¢å¢å¼ºçš„ RAG Agentï¼ˆchapter14.mdï¼‰</h3>
<p>14.1 Search/RAG agent çš„å®šä½ï¼šä»â€œå·¥å…·è°ƒç”¨â€åˆ°â€œçŸ¥è¯†è·å–å›è·¯â€<br />
14.2 å…¸å‹æ¶æ„ï¼šQuery â†’ Search â†’ Rank â†’ Read â†’ Synthesize â†’ Cite<br />
14.3 æŠŠ Search å½“ effectï¼š<code>Search : SearchReq -&gt; m SearchResp</code><br />
14.4 RAG çš„ IO äº‹ä»¶ï¼š  </p>
<ul>
<li>æŸ¥è¯¢è¶…æ—¶/éƒ¨åˆ†ç»“æœ  </li>
<li>ç»“æœé‡å¤/æ±¡æŸ“ï¼ˆSEO spamã€æ¨¡æ¿ç«™ï¼‰  </li>
<li>
<p>å¼•ç”¨ç¼ºå¤±ä¸â€œæ— æ³•è¯æ˜â€<br />
14.5 Query ç”Ÿæˆç­–ç•¥ï¼šsingle-shot vs multi-hopï¼›Kleisli ä¸²è”<br />
14.6 ç»“æœå»é‡ä¸èšç±»ï¼šåŒæº/è¿‘é‡å¤ã€canonical URLã€å†…å®¹å“ˆå¸Œ<br />
14.7 Ranking ä¸ rerankï¼š  </p>
</li>
<li>
<p>è§„åˆ™ï¼ˆBM25/åŸŸåç™½åå•ï¼‰  </p>
</li>
<li>æ¨¡å‹ rerankï¼ˆcross-encoder / LLM judgeï¼‰  </li>
<li>
<p>â€œå¯è§£é‡Šè¯„åˆ†â€ä½œä¸ºæ—¥å¿—äº‹ä»¶<br />
14.8 Reading ç­–ç•¥ï¼š  </p>
</li>
<li>
<p>chunking ä¸çª—å£  </p>
</li>
<li>è¯æ®æŠ½å–ï¼ˆclaim-evidenceï¼‰  </li>
<li>
<p>åè¯æœç´¢ï¼ˆdisconfirming evidenceï¼‰<br />
14.9 å¯ä¿¡ä¸å®‰å…¨ï¼š  </p>
</li>
<li>
<p>å¼•ç”¨çº¦æŸï¼ˆæ¯æ¡å…³é”®æ–­è¨€éƒ½è¦å¯è¿½æº¯è¯æ®ï¼‰  </p>
</li>
<li>å¯ä¿¡ä¼˜å…ˆï¼ˆç«™ç‚¹è´¨é‡ã€ä½œè€…ã€æ—¶æ•ˆï¼‰  </li>
<li>
<p>é˜²æç¤ºæ³¨å…¥ï¼ˆç½‘é¡µå†…å®¹ä½œä¸ºä¸å¯ä¿¡è¾“å…¥ï¼‰<br />
14.10 â€œæ£€ç´¢å›è·¯â€çš„ loop detectionï¼š  </p>
</li>
<li>
<p>æœç´¢è¯éœ‡è¡ï¼ˆquery driftï¼‰  </p>
</li>
<li>æ°¸è¿œæ‰¾ä¸åˆ°è¯æ®æ—¶çš„ç»ˆæ­¢æ¡ä»¶  </li>
<li>
<p>budget é©±åŠ¨çš„â€œåœæ­¢æ£€ç´¢ï¼Œè½¬ä¸ºä¸ç¡®å®šå›ç­”â€<br />
14.11 A/B ä¸è¯„ä¼°ï¼š  </p>
</li>
<li>
<p>retrieval æŒ‡æ ‡ï¼ˆrecall@kã€nDCGï¼‰  </p>
</li>
<li>ç«¯åˆ°ç«¯æŒ‡æ ‡ï¼ˆanswer accuracyã€citation precisionï¼‰  </li>
<li>ç¦»çº¿å›æ”¾ï¼šå›ºå®šæœç´¢ç»“æœé›† vs åœ¨çº¿å®æ—¶æœç´¢<br />
14.12 ä¸ FRPï¼šæµå¼å±•ç¤ºæœç´¢è¿‡ç¨‹ï¼ˆquery/ç»“æœ/è¯æ®/å¼•ç”¨ï¼‰<br />
14.13 ç« èŠ‚ç»ƒä¹ ï¼šå†™ä¸€ä¸ªâ€œå¸¦å¼•ç”¨çº¦æŸâ€çš„ RAG agent æœ€å°å®ç°</li>
</ul>
            </article>
            
            <nav class="page-nav"><a href="chapter1.html" class="nav-link next">Chapter 1 â€” LLM Agent çš„â€œæŠ½è±¡è¾¹ç•Œâ€ï¼šä¸ºä»€ä¹ˆä» IO Monad å‡ºå‘ â†’</a></nav>
        </main>
    </div>
</body>
</html>